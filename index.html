<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Happy Finals Week</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />

<style>
:root{
  /* Slightly darker pastel blue */
  --bg1:#b8dced;
  --bg2:#d4ecf8;
  --bg3:#eef7fc;
  --accent:#2f87c6;
  --accent2:#4fa3dc;
  --text:#0b2e4a;
  --shadow:0 18px 40px rgba(30,90,140,.30);
  --card1:#c6e4f4;
  --card2:#b8dced;
}

*{box-sizing:border-box;margin:0;padding:0}

body{
  font-family:"SF Pro Rounded",system-ui,sans-serif;
  background:
    radial-gradient(circle at top left, var(--bg1), var(--bg2)),
    linear-gradient(180deg, var(--bg2), var(--bg3));
  min-height:100vh;
  width:100vw;
  overflow:hidden;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  text-align:center;
  color:var(--text);

  /* Safe-area aware padding for mobile notches/home bar */
  padding:
    calc(18px + env(safe-area-inset-top))
    calc(18px + env(safe-area-inset-right))
    calc(18px + env(safe-area-inset-bottom))
    calc(18px + env(safe-area-inset-left));
}

/* floating bubbles */
.bubble{
  position:absolute;border-radius:999px;opacity:.45;filter:blur(2px);
  animation:float 12s ease-in-out infinite;pointer-events:none;
}
.b1{width:340px;height:340px;background:#a9d3ea;top:-90px;left:-60px}
.b2{width:280px;height:280px;background:#bcdff2;bottom:-90px;right:-80px}
.b3{width:220px;height:220px;background:#d0eaf7;top:48%;right:-90px}
@keyframes float{
  0%,100%{transform:translate(0,0)}
  50%{transform:translate(12px,-22px)}
}

/* logo (optional) */
.logo{
  width:clamp(86px, 18vw, 130px);
  max-width:40vw;
  margin-bottom:clamp(10px, 2vw, 14px);
  filter: drop-shadow(0 6px 14px rgba(0,0,0,.18));
}
.logo { cursor: pointer; }

/* Typography scales smoothly */
#title{
  font-size:clamp(30px, 5.2vw, 54px);
  font-weight:900;
  margin-bottom:6px;
  letter-spacing:.02em;
}

#subtitle{
  font-size:clamp(16px, 3.2vw, 26px);
  font-weight:800;
  opacity:.9;
  margin-bottom:clamp(12px, 2.8vw, 18px);
}

/* Prevent time from shifting when seconds change */
#time{
  display:flex;
  align-items:baseline;
  justify-content:center;
  gap:10px;
  font-variant-numeric: tabular-nums;

  font-size:clamp(58px, 10vw, 120px);
  font-weight:900;
  letter-spacing:.03em;
}

#time .seconds{
  display:inline-block;
  min-width:2.4ch;
  text-align:right;
  font-size:clamp(22px, 4.5vw, 52px);
  opacity:.9;
}

#time .ampm{
  display:inline-block;
  min-width:3.2ch;
  text-align:left;
  font-size:clamp(22px, 4.5vw, 52px);
}

#date{
  font-size:clamp(16px, 3.6vw, 30px);
  margin-top:6px;
  opacity:.85;
  font-weight:700;
}

.badge{
  margin-top:clamp(12px, 2.2vw, 18px);
  padding:12px 26px;
  font-size:clamp(14px, 2.2vw, 18px);
  border-radius:999px;
  background:linear-gradient(135deg,var(--accent),var(--accent2));
  color:#fff;
  font-weight:900;
  letter-spacing:.08em;
  text-transform:uppercase;
  box-shadow:0 8px 20px rgba(47,135,198,.45);
}

/* Responsive card sizing (no fixed min-width) */
.card{
  margin-top:clamp(14px, 2.6vw, 22px);
  width:min(720px, 92vw);
  background:linear-gradient(180deg,var(--card1),var(--card2));
  box-shadow:0 18px 44px rgba(47,135,198,.35);
  border-radius:28px;
  padding:clamp(16px, 3vw, 20px) clamp(16px, 3.2vw, 26px);
}

.card-label{
  font-size:clamp(14px, 2.2vw, 18px);
  font-weight:900;
  letter-spacing:.12em;
  text-transform:uppercase;
  margin-bottom:10px;
}

.card-main{
  font-size:clamp(34px, 7vw, 58px);
  font-weight:1000;
}

.card-sub{
  margin-top:8px;
  font-size:clamp(14px, 2.4vw, 18px);
  font-weight:700;
  opacity:.85;
}

.encouragement{
  position:absolute;
  bottom:calc(16px + env(safe-area-inset-bottom));
  font-size:clamp(14px, 2.6vw, 20px);
  font-weight:800;
  padding:12px 22px;
  border-radius:999px;
  background:rgba(255,255,255,.78);
  backdrop-filter: blur(6px);
  box-shadow:0 10px 26px rgba(47,135,198,.35);
  opacity:0;
  transition:opacity 1.2s ease;
  max-width:92vw;
}
.encouragement.show{opacity:1}

/* TIME'S UP overlay + confetti */
.overlay{
  position:fixed; inset:0;
  background:rgba(230,244,248,.92);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:50;
  padding:
    calc(18px + env(safe-area-inset-top))
    calc(18px + env(safe-area-inset-right))
    calc(18px + env(safe-area-inset-bottom))
    calc(18px + env(safe-area-inset-left));
}
.overlay.show{display:flex;}

.overlay-card{
  width:min(760px,92vw);
  background:linear-gradient(180deg,#dff2fb,#c6e4f4);
  border-radius:34px;
  box-shadow:0 28px 80px rgba(30,90,140,.35);
  padding:clamp(22px, 5vw, 40px) clamp(18px, 4vw, 30px) clamp(18px, 4vw, 28px);
  position:relative;
  overflow:hidden;
}
.overlay-title{
  font-size:clamp(38px, 7vw, 62px);
  font-weight:1000;
}
.overlay-sub{
  margin-top:10px;
  font-size:clamp(16px, 3vw, 22px);
  font-weight:800;
  opacity:.85;
}
.overlay-btn{
  margin-top:18px;
  border:none;
  border-radius:999px;
  padding:12px 18px;
  font-size:16px;
  font-weight:900;
  background:linear-gradient(135deg,var(--accent),var(--accent2));
  color:white;
  cursor:pointer;
  box-shadow:0 10px 28px rgba(47,135,198,.45);
}

.confetti{
  position:absolute;
  top:-20px;
  width:12px;
  height:18px;
  border-radius:4px;
  opacity:.95;
  animation: fall linear forwards;
}
@keyframes fall{
  to { transform: translateY(110vh) rotate(520deg); }
}
</style>
</head>

<body>
  <div class="bubble b1"></div>
  <div class="bubble b2"></div>
  <div class="bubble b3"></div>

  <a href="https://www.vcs.net/high-school" target="_blank" rel="noopener">
    <img src="vc-logo.png"
         alt="School Logo"
         class="logo"
         onerror="this.style.display='none';" />
  </a>

  <div id="title">Happy Finals Week</div>
  <div id="subtitle">Loading scheduleâ€¦</div>

  <div id="time">--:-- <span class="seconds">--</span> <span class="ampm">--</span></div>
  <div id="date">Loadingâ€¦</div>
  <div class="badge">Pacific Time</div>

  <div class="card">
    <div class="card-label" id="modeLabel">Countdown</div>
    <div class="card-main" id="countdown">--:--</div>
    <div class="card-sub" id="rangeText">â€”</div>
  </div>

  <div class="encouragement" id="encouragement"></div>

  <div class="overlay" id="overlay" aria-live="assertive">
    <div class="overlay-card" id="overlayCard">
      <div class="overlay-title">TIMEâ€™S UP! ðŸŽ‰</div>
      <div class="overlay-sub" id="overlaySub">â€”</div>
      <button class="overlay-btn" id="dismiss">Hide</button>
    </div>
  </div>

<script>
/* =========================
   CONFIG
========================= */
const TZ = "America/Los_Angeles";

/* Finals schedule (PT) */
const SCHEDULE = [
  { date: "2025-12-16", blocks: [
    { label: "1A", start: "09:00", end: "10:30" },
    { label: "2A", start: "11:00", end: "12:30" },
    { label: "1B", start: "13:00", end: "14:30" },
  ]},
  { date: "2025-12-17", blocks: [
    { label: "2B", start: "09:00", end: "10:30" },
    { label: "3B", start: "11:00", end: "12:30" },
    { label: "Make-ups", start: "13:00", end: "14:30" },
  ]},
  { date: "2025-12-18", blocks: [
    { label: "3A", start: "09:00", end: "10:30" },
    { label: "4A", start: "11:00", end: "12:30" },
    { label: "Make-ups", start: "13:00", end: "14:30" },
  ]},
  { date: "2025-12-19", blocks: [
    { label: "4B", start: "09:00", end: "10:30" },
  ]},
];

/* Encouragement rotation (general + Bible verses) */
const sayings = [
  "Stay focused. One question at a time.",
  "You prepared for this. Trust what you know.",
  "Take a breath and keep moving.",
  "Focus on whatâ€™s in front of you right now.",
  "Do the next right thing.",
  "Youâ€™re capable and prepared.",
  "Steady progress is still progress.",
  "â€œDo not be anxious about anything.â€ â€” Philippians 4:6",
  "â€œI can do all things through Him who strengthens me.â€ â€” Philippians 4:13",
  "â€œBe strong and courageous.â€ â€” Joshua 1:9",
  "â€œCommit your work to the Lord.â€ â€” Proverbs 16:3",
  "â€œThe Lord is my strength.â€ â€” Psalm 28:7",
  "â€œPeace I leave with you.â€ â€” John 14:27"
];

/* Milestones during an active final */
const milestoneMsgs = {
  30: "30 minutes left â€” stay steady.",
  10: "10 minutes left â€” finish strong.",
  5:  "5 minutes left â€” wrap it up."
};

/* =========================
   TIME HELPERS (PT-safe)
========================= */
const pad2 = n => String(n).padStart(2,"0");

function getLAparts(date){
  const parts = new Intl.DateTimeFormat("en-US",{
    timeZone: TZ,
    year:"numeric",month:"2-digit",day:"2-digit",
    hour:"2-digit",minute:"2-digit",second:"2-digit",
    hour12:false
  }).formatToParts(date);
  const m = {};
  parts.forEach(p => { if (p.type !== "literal") m[p.type] = p.value; });
  return { y:+m.year, mo:+m.month, d:+m.day, h:+m.hour, mi:+m.minute, s:+m.second };
}

function laLocalToUTCms(y, mo, d, h, mi, s=0){
  const guessUTC = Date.UTC(y, mo-1, d, h, mi, s);
  const guessParts = getLAparts(new Date(guessUTC));
  const desired = Date.UTC(y, mo-1, d, h, mi, s);
  const got = Date.UTC(guessParts.y, guessParts.mo-1, guessParts.d, guessParts.h, guessParts.mi, guessParts.s);
  return guessUTC + (desired - got);
}

function parseHM(hm){
  const [h,m] = hm.split(":").map(Number);
  return {h, m};
}

/* =========================
   SCHEDULE LOGIC
========================= */
function buildTimeline(){
  const out = [];
  for (const day of SCHEDULE){
    const [Y,M,D] = day.date.split("-").map(Number);
    for (const b of day.blocks){
      const {h:sh,m:sm} = parseHM(b.start);
      const {h:eh,m:em} = parseHM(b.end);
      out.push({
        date: day.date,
        label: b.label,
        startHM: b.start,
        endHM: b.end,
        startUTC: laLocalToUTCms(Y,M,D,sh,sm,0),
        endUTC:   laLocalToUTCms(Y,M,D,eh,em,0),
      });
    }
  }
  out.sort((a,b)=>a.startUTC-b.startUTC);
  return out;
}
const TIMELINE = buildTimeline();

/* =========================
   UI + EFFECTS
========================= */
let lastActiveId = null;
let milestoneHit = new Set();
let timesUpFiredFor = null;

function showMsg(text){
  const el = document.getElementById("encouragement");
  el.classList.remove("show");
  setTimeout(()=>{ el.textContent = text; el.classList.add("show"); }, 450);
}
function rotateEncouragement(){
  showMsg(sayings[Math.floor(Math.random()*sayings.length)]);
}

function popConfetti(){
  const card = document.getElementById("overlayCard");
  const pieces = 120;
  for (let i=0;i<pieces;i++){
    const c = document.createElement("div");
    c.className = "confetti";
    c.style.left = (Math.random()*100) + "%";
    c.style.animationDuration = (2.8 + Math.random()*2.2) + "s";
    c.style.animationDelay = (Math.random()*0.35) + "s";
    const hue = 190 + Math.random()*40;
    c.style.background = `hsl(${hue} 85% 75%)`;
    card.appendChild(c);
    setTimeout(()=>c.remove(), 6500);
  }
}

function showTimesUp(block){
  timesUpFiredFor = block.startUTC;
  document.getElementById("overlaySub").textContent = `${block.label} ended (${block.startHM}â€“${block.endHM} PT)`;
  document.getElementById("overlay").classList.add("show");
  popConfetti();
}

/* =========================
   MAIN TICK
========================= */
function tick(){
  const now = new Date();

  // top clock
  const tparts = new Intl.DateTimeFormat("en-US",{
    timeZone: TZ, hour:"numeric", minute:"2-digit", second:"2-digit", hour12:true
  }).formatToParts(now);

  let hh="", mm="", ss="", ampm="";
  tparts.forEach(p=>{
    if(p.type==="hour") hh=p.value;
    if(p.type==="minute") mm=p.value;
    if(p.type==="second") ss=p.value;
    if(p.type==="dayPeriod") ampm=p.value.toUpperCase();
  });

  document.getElementById("time").innerHTML =
    `${hh}:${mm} <span class="seconds">${ss}</span> <span class="ampm">${ampm}</span>`;

  document.getElementById("date").textContent =
    new Intl.DateTimeFormat("en-US",{ timeZone: TZ, weekday:"long", year:"numeric", month:"long", day:"numeric" }).format(now);

  const nowMs = now.getTime();

  // find active or next block
  let active = null;
  let next = null;

  for (const b of TIMELINE){
    if (nowMs >= b.startUTC && nowMs < b.endUTC) { active = b; break; }
    if (nowMs < b.startUTC) { next = b; break; }
  }

  const subtitleEl = document.getElementById("subtitle");
  const modeLabelEl = document.getElementById("modeLabel");
  const countdownEl = document.getElementById("countdown");
  const rangeTextEl = document.getElementById("rangeText");

  if (active){
    const activeId = active.startUTC;
    if (lastActiveId !== activeId){
      lastActiveId = activeId;
      milestoneHit = new Set();
    }

    subtitleEl.textContent = `Final: ${active.label}`;
    modeLabelEl.textContent = "Time left in final";
    rangeTextEl.textContent = `${active.startHM}â€“${active.endHM} PT`;

    const remainingMs = Math.max(0, active.endUTC - nowMs);
    const totalSec = Math.floor(remainingMs / 1000);
    const minsLeft = Math.floor(totalSec / 60);

    const H = Math.floor(totalSec / 3600);
    const M = Math.floor((totalSec % 3600) / 60);
    const S = totalSec % 60;

    if (minsLeft <= 10){
      countdownEl.textContent = `${pad2(H)}:${pad2(M)}:${pad2(S)}`;
    } else {
      const totalMinCeil = Math.ceil(remainingMs / 60000);
      const h2 = Math.floor(totalMinCeil / 60);
      const m2 = totalMinCeil % 60;
      countdownEl.textContent = `${pad2(h2)}:${pad2(m2)}`;
    }

    [30,10,5].forEach(mark=>{
      if (minsLeft === mark && !milestoneHit.has(mark)){
        milestoneHit.add(mark);
        showMsg(milestoneMsgs[mark]);
      }
    });

    if (remainingMs <= 0 && timesUpFiredFor !== active.startUTC){
      showTimesUp(active);
    }

  } else if (next){
    subtitleEl.textContent = `Next: ${next.label}`;
    modeLabelEl.textContent = "Next final starts in";
    rangeTextEl.textContent = `${next.date} â€¢ ${next.startHM}â€“${next.endHM} PT`;

    const untilMs = Math.max(0, next.startUTC - nowMs);
    const untilSec = Math.floor(untilMs / 1000);
    const H = Math.floor(untilSec / 3600);
    const M = Math.floor((untilSec % 3600) / 60);
    const S = untilSec % 60;

    const minsLeft = Math.floor(untilSec / 60);
    if (minsLeft <= 10){
      countdownEl.textContent = `${pad2(H)}:${pad2(M)}:${pad2(S)}`;
    } else {
      const totalMinCeil = Math.ceil(untilMs / 60000);
      const h2 = Math.floor(totalMinCeil / 60);
      const m2 = totalMinCeil % 60;
      countdownEl.textContent = `${pad2(h2)}:${pad2(m2)}`;
    }

    lastActiveId = null;
    milestoneHit = new Set();

  } else {
    subtitleEl.textContent = "All finals complete";
    modeLabelEl.textContent = "Countdown";
    countdownEl.textContent = "00:00";
    rangeTextEl.textContent = "Have a great break!";
    lastActiveId = null;
    milestoneHit = new Set();
  }
}

/* =========================
   START
========================= */
document.getElementById("dismiss").addEventListener("click", ()=>{
  document.getElementById("overlay").classList.remove("show");
});

rotateEncouragement();
setInterval(rotateEncouragement, 15 * 60 * 1000);

tick();
setInterval(tick, 1000);
</script>

</body>
</html>
